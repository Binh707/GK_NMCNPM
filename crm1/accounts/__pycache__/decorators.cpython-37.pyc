B
    þ^+  ã               @   s8   d dl mZ d dlmZ dd„ Zg fdd„Zd d„ Zd	S )
é    )ÚHttpResponse)Úredirectc                s   ‡ fdd„}|S )Nc                s$   | j jrtdƒS ˆ | f|ž|ŽS d S )NÚhome)ÚuserÚis_authenticatedr   )Ú requestÚargsÚkwargs)Ú	view_func© ú;C:\Users\denni\OneDrive\Desktop\crm1\accounts\decorators.pyÚwrapper_func   s    z*unauthenticated_user.<locals>.wrapper_funcr
   )r
   r
   r
   )r
   r   Úunauthenticated_user   s    r   c                s   ‡ fdd„}|S )Nc                s   ‡‡ fdd„}|S )Nc                sF   d }| j j ¡ r"| j j ¡ d j}|ˆ kr:ˆ| f|ž|ŽS tdƒS d S )Nr   z(You are not authorized to view this page)r   ÚgroupsÚexistsÚallÚnamer   )r    r   r	   Úgroup)Ú
allowed_rolesr
   r
   r   r
      s    z6allowed_users.<locals>.decorator.<locals>.wrapper_funcr
   )r
   r
   )r   )r
   r   Ú	decorator   s    
z allowed_users.<locals>.decoratorr
   )r   r   r
   )r   r   Ú
allowed_users
   s    r   c                s   ‡ fdd„}|S )Nc                sN   d }| j j ¡ r"| j j ¡ d j}|dkr2tdƒS |dkrJˆ | f|ž|ŽS d S )Nr   Úcustomerz	user-pageÚadmin)r   r   r   r   r   r   )r    r   r	   r   )r
   r
   r   Úwrapper_function   s    z$admin_only.<locals>.wrapper_functionr
   )r
   r   r
   )r
   r   Ú
admin_only   s    
r   N) Ú
django.httpr   Údjango.shortcutsr   r   r   r   r
   r
   r
   r   Ú<module>   s   	